\chapter{Definitions of physics objects and observables}
\label{chap:objects}

% Not sure if I should discuss corrections to objects (like JER/JES corrections to jets) in this chapter, or in the analysis chapter since the systematic should be documented there

\epigraph{You know when grown-ups tell you everything’s going to be fine, but you really think they’re lying to make you feel better? Everything’s going to be fine.}{--- The Eleventh Doctor, \emph{Doctor Who}}

This chapter first discusses some prevalent variables used in the analyses presented in this thesis. Accordingly, it is practical to consolidate their definitions here. The rest of the chapter is devoted to classification of the physics objects that inform the analysis in Chpt.~\ref{chap:higgstoinv}.


%=========================================================


\section{Ubiquitous observables and quantities in collider physics}
\label{sec:objects_important_observables}


%=========================================================


\subsection{The electron volt}
\label{subsec:objects_electron_volt}

In highly relativistic systems, such as beams of particles in accelerators, the ability to simply equate mass, energy, and momentum is desirable. In the \acrshort{lhc}, when protons are accelerated to an enormous Lorentz boost factor, their invariant mass $m_0$ contributes little to their total energy $E$. With Einstein's energy-momentum relation from the special theory of relativity, one can express the energy as functions of intrinsic mass and relativistic momentum:
\begin{equation}
    E^2 = (pc)^2 + (m_0c^2)^2
    \label{eq:e_mc2}
\end{equation}

where $p$ is the magnitude of the momentum and $c$ is the speed of light. For highly relativistic objects, $pc \gg m_0c^2$ and so $E \approx pc$. At rest, $E = m_0c^2$. The \acrfull{ev} unit is common in high energy physics. Its value is the energy supplied to (or removed from) an electron accelerated through a potential difference of 1\,V: $\text{1.6}\times \text{10}^{-19}$\,J. The momentum gained is then $\text{1}\eVc$ and relativistic mass $\text{1}\eVcc$. The factors of $c$ and $c^2$ are often dropped in less formal contexts, or when using natural units (where $c = \text{1}$).

An \acrlong{ev} is a minute quantity of energy, so when discussing properties of high energy particles and accelerators, a long string of digits may be required to express them. SI prefixes mitigate this problem and provide an intuitive sense of scale to scientists. The most frequently used in the context of \acrshort{lhc} physics are \emph{mega} (M, $\text{10}^6$), \emph{giga} (G, $\text{10}^9$), and \emph{tera} (T, $\text{10}^{12}$). For example, the mass of a proton is $\text{0.93}\GeVcc$ and the present centre of mass energy of the \acrshort{lhc} is $\text{13}\TeV$, which are much more natural and understandable numbers than $\text{1.78}\times \text{10}^{-27}$\,kg or $\text{1.6}\times \text{10}^{-7}$\,J, respectively.


%=========================================================


\subsection{Transverse momentum (\texorpdfstring{\ptvec}{pt})}
\label{subsec:objects_pt}

In the \acrshort{lhc} (or any other hadron collider), the longitudinal momenta of the proton constituents that collide are typically unknown. However, the momentum transverse to the beam is zero before the collision, and must be zero afterward after due to momentum conservation. This is why the transverse momentum of a particle or physics object (\ptvec for the vector quantity, \pt for its magnitude) is a useful variable in an analysis.


%=========================================================


\subsection{\texorpdfstring{\HT}{HT}}
\label{subsec:objects_ht}

For analyses focused on hadronic objects---such as branches of \acrlong{susy} where a large \gls{jet} multiplicity is expected---it is practical to define the total amount of hadronic activity in an event. The scalar sum of the transverse momentum of the \glspl{jet} is symbolised as \HT:
\begin{equation}
    \HT \equiv \sum_{\mathrm{jets}} \pt
    \label{eq:ht_definition}
\end{equation}

Typically, a lower limit on the \pt is used when calculating the \HT, so \glspl{jet} below this threshold do not factor into the sum. This is to avoid low momentum \glspl{jet} attributed to pileup events (see Chpt.~\ref{subsec:pileup}) and soft radiation.


%=========================================================


\subsection{Missing transverse momentum (\texorpdfstring{\ptvecmiss}{ptmiss})}
\label{subsec:objects_met}

The missing transverse momentum \ptvecmiss is defined as the negative vector sum of the \ptvec of all identified particles in an event. It is a term often used interchangeably with \gls{met} (MET, \VEtmiss). Undetected particles from neutrinos or dark matter, or mismeasured kinematic properties of identified particles, will introduce an imbalance in the vector sum of the \ptvec. Hence, the \ptvecmiss will be non-zero. Formally,
\begin{equation}
    \begin{aligned}
        \ptvecmiss &\equiv - \sum_i^{N_{\mathrm{particles}}} \vec{p}_{\mathrm{T}, \, i} \\
        \ptmiss &\equiv \abs{\ptvecmiss}
    \end{aligned}
    \label{eq:met_definition}
\end{equation}
The hadronic-only counterpart to this variable, \htvecmiss, is the negative vector sum of the \gls{jet} transverse momenta in an event:
\begin{equation}
    \begin{aligned}
        \htvecmiss &\equiv - \sum_j^{N_{\mathrm{jets}}} \vec{p}_{\mathrm{T}, \, j} \\
        \mht &\equiv \abs{\htvecmiss}
    \end{aligned}
    \label{eq:mht_definition}
\end{equation}
As with \HT, the \mht is often calculated with a lower limit on the \gls{jet} \pt.


%=========================================================


\subsection{Transverse mass (\texorpdfstring{\mT}{MT})}
\label{subsec:objects_transverse_mass}

The transverse mass \mT of a particle---or the collective products of a decay---is the component of its invariant mass in the transverse plane. In a hadron collider context, this observable is often used when one of the decay products is invisible or unidentified, i.e., as \ptvecmiss. When searching for \glspl{svj}, the \mT of the dijet system is very reliable in recovering the \PZprime mass. Eq.~\ref{eq:e_mc2} can be reformulated for each daughter particle in a decay as
\begin{equation}
\ET^2 = m_0^2 + \pt^2
\label{eq:transverse_energy}
\end{equation}

where \ET is the transverse energy. The transverse mass of the system is then
\begin{equation}
    \begin{aligned}
\mT^2 &= (E_{\mathrm{T,1}} + E_{\mathrm{T,2}})^2 - ({\vec p}_{\mathrm{T,1}} + {\vec p}_{\mathrm{T,2}})^2 \\
&= m_1^2 + m_2^2 + 2(E_{\mathrm{T,1}} E_{\mathrm{T,2}} - {\vec p}_{\mathrm{T,1}} \cdot {\vec p}_{\mathrm{T,2}})
    \end{aligned}
\label{eq:transverse_mass_massive}
\end{equation}

In the case of one unidentified daughter, the \ptvecmiss may substitute a particle in the first line of Eq.~\ref{eq:transverse_mass_massive}. If one also treats the daughters as massless, i.e., if $\pt \gg m_0$ like with boosted leptons, the formula approximates to
\begin{equation}
\mT^2 = 2 \pt \ptmiss (1 - \cos(\Delta\phi))
\label{eq:transverse_mass_massless}
\end{equation}
where $\Delta\phi = \phi - \phi(\ptvecmiss)$, and \pt and $\phi$ are from the identified daughter.


%=========================================================


\section{Classification of analysis-level physics objects}
\label{sec:analysis_objects}

The physics that occurs at the high energies the \acrshort{lhc} is capable of is not simple. That makes the recording of particles and events overall a non-trivial undertaking. Based on complex hardware and software, research, and the experience of previous experiments, establishing physics objects and variables from an analyst's standpoint is thankfully straightforward. The basic definitions are already included into the \ROOT files we use, with ancillary selections on top for the analysis-level objects. All of the descriptions that follow apply both to data and simulated samples, unless otherwise stated.

Different working points for the identification of many objects are available from the respective \glspl{pog}, trading efficiency for purity the tighter the restrictions are. ``Veto,'' ``loose,'' ``medium,'' and ``tight'' criteria exist for most objects. We denote particles with a subscript that signifies the working point. The requirements of which are elaborated upon in the ensuing subsections.


%=========================================================


\subsection{Jets}
\label{subsec:objects_jets}

In the nanoAOD data tier, a \gls{jet} is defined as an AK4-clustered, charged hadron-subtracted object reconstructed with the \gls{particleflow}, with \acrlong{jec} applied and a $\pt > \text{15}\GeV$ prerequisite. For the analysis, we then apply the \emph{latest} \acrshort{jec} and \acrfull{jer} treatments to both data and simulation to determine the \pt. Those with $\pt > \text{30}\GeV$ are kept. The \acrshort{jer} is worse in data than in simulation, so \glspl{jet} in the latter are smeared to describe the former more accurately.

% JER smearing: https://twiki.cern.ch/twiki/bin/viewauth/CMS/JetResolution#Smearing_procedures. Info about the stuff added by the jetmetHelper module in nanoAOD-tools: https://twiki.cern.ch/twiki/bin/view/CMSPublic/WorkBookNanoAOD#JME_jetmet_HelperRun2

The tight, with or without an additional lepton veto, \acrshort{pf} identification requirements are also mandatory to establish a sufficient degree of purity with a very high efficiency ($> \text{98\,\%}$ in all $\abseta$ regions). These are documented in Tabs.~\ref{tab:htoinv_jet_id_def_2016}, \ref{tab:htoinv_jet_id_def_2017}, and \ref{tab:htoinv_jet_id_def_2018}. For all years, both the identification and background rejection efficiencies are above 98\,\% in the barrel and end caps.

A \gls{jet} suspected to originate from a \Pbottom-quark, or \emph{\gls{bjet}}, is described by a nanoAOD AK4 \gls{jet} with corrected $\pt > \text{20}\GeV$ and within the acceptance of the tracker---$\abseta < \text{2.4}$ in 2016, and $< \text{2.5}$ onward. It is also required to satisfy the medium working point (a mis-tag rate of 1\,\%) from the \deepcsv algorithm~\cite{Sirunyan:2017ezt}.


%=========================================================


\subsubsection{2016}
\label{subsubsec:objects_jets_2016}

The tight and tight $+$ lepton veto ID specifications are detailed in Tab.~\ref{tab:htoinv_jet_id_def_2016}. Specifically to this year, all \glspl{jet} are required to fulfill the criteria for the tight pileup ID to ensure they do not originate from pileup vertices.

\begin{table}[htbp]
    \centering
    \begin{tabular}{lcccc}
        \hline
        Criterion & $\abseta \leq \text{2.4}$ & $\text{2.4} < \abseta \leq \text{2.7}$ & $\text{2.7} < \abseta \leq \text{3.0}$ & $\abseta \geq \text{3.0}$ \\\hline
        Neutral hadron fraction & $< \text{0.90}$ & $< \text{0.90}$ & $< \text{0.98}$ & --- \\
        Neutral EM fraction & $< \text{0.90}$ & $< \text{0.90}$ & $> \text{0.01}$ & $< \text{0.90}$ \\
        \# constituents & $> \text{1}$ & $> \text{1}$ & --- & --- \\
        Muon energy fraction & $< \text{0.80}$* & $< \text{0.80}$* & --- & --- \\
        Charged hadron fraction & $> \text{0}$ & --- & --- & --- \\
        Charged multiplicity & $> \text{0}$ & --- & --- & --- \\
        Charged EM fraction & $< \text{0.99}$ (0.90*) & --- & --- & --- \\
        \# neutral particles & --- & --- & $> \text{2}$ & $> \text{10}$ \\\hline
    \end{tabular}
    \caption[The requirements for a jet to pass tight identification for data taken in 2016, and to \acrlong{mc} events emulating that year]{The requirements for a \gls{jet} to pass tight identification for data taken in 2016, and to \acrlong{mc} events emulating that year. Information taken from Ref.~\citenum{cms_jet_ID_2016}.
        
    * Only applies to the tight $+$ lepton veto ID.}
    \label{tab:htoinv_jet_id_def_2016}
\end{table}


%=========================================================


\subsubsection{2017}
\label{subsubsec:objects_jets_2017}

The tight and tight $+$ lepton veto ID conditions are detailed in Tab.~\ref{tab:htoinv_jet_id_def_2017}. \Glspl{jet} with $\pt < \text{50}\GeV$ are required to meet the tight pileup ID criteria. Any \glspl{jet} with a raw (uncorrected) transverse momentum $\pt^{\mathrm{raw}} < \text{50}\GeV$ within the region $\text{2.65} < \abseta < \text{3.139}$ are vetoed due to noise in the \acrshort{ecal} end cap.

% These noisy EE jets are described in https://docs.google.com/presentation/d/1PMWr9QEaHYAbyi6yAFLHEE6KT-u7Cjwm3wniJZCixcU/edit#slide=id.p

\begin{table}[htbp]
    \centering
    \begin{tabular}{lcccc}
        \hline
        Criterion & $\abseta \leq \text{2.4}$ & $\text{2.4} < \abseta \leq \text{2.7}$ & $\text{2.7} < \abseta \leq \text{3.0}$ & $\abseta \geq \text{3.0}$ \\\hline
        Neutral hadron fraction & $< \text{0.90}$ & $< \text{0.90}$ & --- & $> \text{0.02}$ \\
        Neutral EM fraction & $< \text{0.90}$ & $< \text{0.90}$ & $> \text{0.02}$, $< \text{0.99}$ & $< \text{0.90}$ \\
        \# constituents & $> \text{1}$ & $> \text{1}$ & --- & --- \\
        Muon energy fraction & $< \text{0.80}$* & $< \text{0.80}$* & --- & --- \\
        Charged hadron fraction & $> \text{0}$ & --- & --- & --- \\
        Charged multiplicity & $> \text{0}$ & --- & --- & --- \\
        Charged EM fraction & $< \text{0.80}$* & --- & --- & --- \\
        \# neutral particles & --- & --- & $> \text{2}$ & $> \text{10}$ \\\hline
    \end{tabular}
    \caption[The requirements for a jet to pass tight identification for data taken in 2017, and to \acrlong{mc} events emulating that year]{The requirements for a \gls{jet} to pass tight identification for data taken in 2017, and to \acrlong{mc} events emulating that year. Information taken from Ref.~\citenum{cms_jet_ID_2017}.
        
    * Only applies to the tight $+$ lepton veto ID.}
    \label{tab:htoinv_jet_id_def_2017}
\end{table}


%=========================================================


\subsubsection{2018}
\label{subsubsec:objects_jets_2018}

The tight and tight $+$ lepton veto ID specifications are detailed in Tab.~\ref{tab:htoinv_jet_id_def_2018}.\footnote{There's probably a more elegant way to write the ID criteria, since the same variables are used for all years and the same thresholds in many cases. But until I figure it out, separate tables for each year will have to do} As in 2017, \glspl{jet} with $\pt < \text{50}\GeV$ must fulfill the tight pileup ID conditions.\footnote{Is it worth going into the pileup ID spec.?}

\begin{table}[htbp]
    \centering
    \begin{tabular}{lcccc}
        \hline
        Criterion & $\abseta \leq \text{2.6}$ & $\text{2.6} < \abseta \leq \text{2.7}$ & $\text{2.7} < \abseta \leq \text{3.0}$ & $\text{3.0} < \abseta \leq \text{5.0}$ \\\hline
        Neutral hadron fraction & $< \text{0.90}$ & $< \text{0.90}$ & --- & $> \text{0.20}$ \\
        Neutral EM fraction & $< \text{0.90}$ & $< \text{0.99}$ & $> \text{0.02}$, $< \text{0.99}$ & $< \text{0.90}$ \\
        \# constituents & $> \text{1}$ & --- & --- & --- \\
        Muon energy fraction & $< \text{0.80}$* & $< \text{0.80}$* & --- & --- \\
        Charged hadron fraction & $> \text{0}$ & --- & --- & --- \\
        Charged multiplicity & $> \text{0}$ & $> \text{0}$ & --- & --- \\
        Charged EM fraction & $< \text{0.80}$* & $< \text{0.80}$* & --- & --- \\
        \# neutral particles & --- & --- & $> \text{2}$ & $> \text{10}$ \\\hline
    \end{tabular}
    \caption[The requirements for a jet to pass tight identification for data taken in 2018, and to \acrlong{mc} events emulating that year]{The requirements for a \gls{jet} to pass tight identification for data taken in 2018, and to \acrlong{mc} events emulating that year.  Information taken from Ref.~\citenum{cms_jet_ID_2018}.
        
    * Only applies to the tight $+$ lepton veto ID.}
    \label{tab:htoinv_jet_id_def_2018}
\end{table}


%=========================================================


\subsection{Boosted topologies originating from top quarks and electroweak bosons}
\label{subsec:objects_deepak8}

Many traditional methods have been developed to tag \glspl{jet} originating from heavy particles, such as top quarks, vector bosons and Higgs bosons. Though, there are limitations with all of these, and in the era of machine learning a plethora of new tools have arisen. One such algorithm---\deepakeight---has been developed by physicists in \acrshort{cms} to classify \glspl{jet} that originate from numerous heavy particle decays. In the analysis in search of invisibly decaying Higgs bosons, specific interest is paid to those coming from top quarks and vector bosons in order to assist the categorisation of the \ttH and \VH signals. The design and optimisation of the algorithm is described in Ref.~\citenum{CMS-PAS-JME-18-002}.\footnote{Not sure if I should give a summary of the development and features of the algorithm here.}

The algorithm operates on AK8 \glspl{jet}. Following the same reconstruction and identification prescription as AK4 \glspl{jet}, they differ only in the cone size and \pt requirement. Hadrons are clustered with the \gls{antikt} using a radius parameter of 0.8 instead of the usual 0.4, and must possess a $\pt > \text{170}\GeV$. The corrections and uncertainties from \acrshort{jer} and \acrshort{jes} are also propagated identically.

The ensuing selections are applied to AK8 \glspl{jet} to classify them, as recommended by the \deepakeight developers:
\medskip
\begin{easylist}[itemize]
    \ListProperties(Style*=-- , Style2*=$\circ$ , Hang=true, FinalMark={)})
    & Boosted top:
    && $\pt > \text{400}\GeV$
    && $\text{105} < m_{\mathrm{SD}} < \text{210} \GeV$
    && \Ptop vs. \acrshort{qcd} discriminator score with the ``tight'' working point (1\,\% mis-tag rate)

    & Boosted \PVec:
    && $\pt > \text{200}\GeV$
    && $\text{65} < m_{\mathrm{SD}} < \text{105} \GeV$
    && \PW vs. \acrshort{qcd} discriminator score with the ``tight'' working point (1\,\% mis-tag rate)
\end{easylist}

\medskip

\noindent{}Orthogonality is ensured between the two classifications from the soft drop mass $m_{\mathrm{SD}}$~\cite{Larkoski:2014wba} window. The quantity is corrected for pileup contributions using the PUPPI algorithm~\cite{Bertolini:2014bba}. Tight working points that effectively separate the \glspl{jet} from \acrshort{qcd} background ensure a high purity collection. Boosted \PVec \glspl{jet} are not further separated into \PW- and \PZ-tagged since the mass degeneracy makes this inherently difficult. The \PW vs. \acrshort{qcd} discriminator is therefore used to tag both.


%=========================================================


\subsection{Muons}
\label{subsec:objects_muons}

The reconstruction and identification criteria for muons is described in significant detail in Ref.~\citenum{Sirunyan:2018fpa}. From there, a loose muon \looseMuon satisfies the ``loose muon identification'' requirements. Additionally, $\abseta < \text{2.4}$, $\pt > \text{10}\GeV$, and the loose working point of the \acrlong{pf} relative isolation parameter (Eq.~5.4 in Ref.~\citenum{CMS-PRF-14-001}\citenumNegSpace) $I_{\mathrm{PF}} < \text{0.25}$ must be satisfied. A tight muon \tightMuon meets the ``tight muon ID'' requirements from Ref.~\citenum{Sirunyan:2018fpa}, $\abseta < \text{2.4}$, $\pt > \text{20}\GeV$, and the tight working point for the relative isolation ($I_{\mathrm{PF}} < \text{0.15}$).

The relative isolation parameter is the ratio of the sum of track, \acrshort{hcal} and \acrshort{ecal} energies within $\Delta R < \text{0.4}$ of the muon to the particle's momentum. The loose and tight working points are designed to give efficiencies of 98\,\% and 95\,\%, respectively.


%=========================================================


\subsection{Electrons}
\label{subsec:objects_electrons}

In the analysis, electrons are labelled as veto (\vetoEle) or tight electrons (\tightEle), depending on which \acrshort{pog} ID requirements are fulfilled. For 2016--18, version 2 of the cut-based identification scheme (tuned using 2017 samples), is applied. These are distinguished for the barrel region in Tab.~\ref{tab:htoinv_electron_ID_barrel}, and end cap region in Tab.~\ref{tab:htoinv_electron_ID_endcap}. The veto and tight ID specifications are designed for average efficiencies of 95\,\% and 70\,\%, respectively.\footnote{Can't find background rejection efficiencies on twiki pages.}

\begin{table}[htbp]
    \centering
    \begin{tabular}{lcc}
    \hline
    Criterion & Veto & Tight \\\hline
    Full $\text{5} \times \text{5}$ $\sigma_{i\eta i\eta}$ & $< \text{0.0126}$ & $< \text{0.0104}$    \\
    $\abs{\Delta\eta_{\mathrm{in}}^{\mathrm{seed}}}$ & $< \text{0.00463}$ & $< \text{0.00255}$ \\
    $\abs{\Delta\phi_{\mathrm{in}}}$ & $< \text{0.148}$ & $< \text{0.022}$ \\
    $H/E$ & $<\text{0.05} + \frac{\text{1.16}}{E_{\mathrm{SC}}} + \frac{\text{0.0324}\rho}{E_{\mathrm{SC}}}$ & $<$ $\text{0.026} + \frac{\text{1.15}}{E_{\mathrm{SC}}} + \frac{\text{0.0324}\rho}{E_{\mathrm{SC}}}$ \\
    Relative isolation with $A_{\mathrm{eff.}}$ & $< \text{0.198} + \frac{\text{0.506}}{\pt}$ & $< \text{0.0287} + \frac{\text{0.506}}{\pt}$\\
    $\abs{E^{-1}_{\mathrm{ECAL}} - p^{-1}_{\mathrm{Tracker}}}$ & $< \text{0.209}$ & $< \text{0.159}$\\
    Expected missing inner hits & $\leq \text{2}$ & $\leq \text{1}$\\
    Pass conversion veto & yes & yes \\
    \hline
    \end{tabular}
    \caption[Requirements used to define the veto and tight electron IDs in the barrel region (supercluster $\abs{\eta} \leq \text{1.479}$)]{Requirements used to define the veto and tight electron IDs in the barrel region (supercluster $\abs{\eta} \leq \text{1.479}$). Information taken from Ref.~\citenum{cms_ele_ID_Run2}.}
    \label{tab:htoinv_electron_ID_barrel}
\end{table}

\begin{table}[htbp]
    \centering
    \begin{tabular}{lcc}
    \hline
    Criterion & Veto & Tight \\\hline
    Full $\text{5} \times \text{5}$ $\sigma_{i\eta i\eta}$ & $< \text{0.0457}$ & $< \text{0.0353}$    \\
    $\abs{\Delta\eta_{\mathrm{in}}^{\mathrm{seed}}}$ & $< \text{0.00814}$ & $< \text{0.00501}$ \\
    $\abs{\Delta\phi_{\mathrm{in}}}$ & $< \text{0.19}$ & $< \text{0.0236}$ \\
    $H/E$ & $<\text{0.05} + \frac{\text{2.54}}{E_{\mathrm{SC}}} + \frac{\text{0.183}\rho}{E_{\mathrm{SC}}}$ & $<$ $\text{0.0188} + \frac{\text{2.06}}{E_{\mathrm{SC}}} + \frac{\text{0.183}\rho}{E_{\mathrm{SC}}}$ \\
    Relative isolation with $A_{\mathrm{eff.}}$ & $< \text{0.203} + \frac{\text{0.963}}{\pt}$ & $< \text{0.0445} + \frac{\text{0.963}}{\pt}$\\
    $\abs{E^{-1}_{\mathrm{ECAL}} - p^{-1}_{\mathrm{Tracker}}}$ & $< \text{0.132}$ & $< \text{0.0197}$\\
    Expected missing inner hits & $\leq \text{3}$ & $\leq \text{1}$\\
    Pass conversion veto & yes & yes \\
    \hline
    \end{tabular}
    \caption[Requirements used to define the veto and tight electron IDs in the end cap region (supercluster $\abs{\eta} > \text{1.479}$)]{Requirements used to define the veto and tight electron IDs in the end cap region (supercluster $\abs{\eta} > \text{1.479}$). Information taken from Ref.~\citenum{cms_ele_ID_Run2}.}
    \label{tab:htoinv_electron_ID_endcap}
\end{table}

The variable $\sigma_{i\eta i\eta}$ is the energy-weighted standard deviation of the \acrshort{ecal} crystal $\eta$, centred on the local energy maximum, in this case using the full $\text{5} \times \text{5}$ crystal information from the calorimeter tower. $\Delta\eta_{\mathrm{in}}^{\mathrm{seed}}$ and $\Delta\phi_{\mathrm{in}}$ are the differences in pseudorapidity and azimuthal angle, respectively, between the supercluster (seed in the case of $\Delta\eta$) and the track. $H/E$ is the ratio of the candidate's central energy deposit in the \acrshort{hcal} to the \acrshort{ecal}. The relative isolation parameter is computed in the same way as muons (Eq.~5.4 in Ref.~\citenum{CMS-PRF-14-001}\citenumNegSpace), but uses a cone of $\Delta R < \text{0.3}$ instead of 0.4. The isolation threshold takes the effective area $A_{\mathrm{eff.}}$ into account. Along with $\rho$---a parameter in the \textsc{FastJet} package~\cite{Cacciari:2011fastjet} used for \gls{jet} finding---these are used for estimating the contamination from pileup in an event. $E_{\mathrm{SC}}$ is the energy of the supercluster, and is used to scale the isolation requirement. From material interactions within the tracker, photons may convert into $\Ppositron\Pelectron$ pairs. A dedicated veto aims to mitigate this effect.
% rho and A_eff: https://iopscience.iop.org/article/10.1088/1748-0221/10/08/P08010/pdf
% More electron stuff in reference to tables above: https://twiki.cern.ch/twiki/bin/view/CMSPublic/SWGuideGsfElectronObject

Common to all electrons in the analysis, we place a cut of $\abseta < \text{2.5}$ so they are reconstructed with tracker information. To further utilise the subdetector, impact parameter conditions on the transverse and longitudinal directions ensure they originate sufficiently close to the primary vertex: $d_0 < \text{0.05}$\,cm and $dz < \text{0.1}$\,cm in the barrel, with $d_0 < \text{0.1}$\,cm and $dz < \text{0.2}$\,cm in the end cap. The \vetoEle and \tightEle sets are only separated by the identification prerequisites above, and transverse momentum. A veto electron requires $\pt > \text{10}\GeV$, and a tight electron $\pt > \text{40}\GeV$.


%=========================================================


\subsection{Photons}
\label{subsec:objects_photons}

Photons are identified in a similar manner to electrons---using version 2 of the cut-based scheme for 2016--18, optimised with 2017 \acrlong{mc}. We define loose \loosePhoton and medium photons \mediumPhoton that fulfill the corresponding working point criteria for identification. For inclusivity, the latter is used instead of the tight working point. These are detailed in Tab.~\ref{tab:htoinv_photon_ID_barrel} and Tab.~\ref{tab:htoinv_photon_ID_endcap} for the barrel and end cap regions, respectively. The loose photon ID specification is designed to be 90\,\% efficient, and the medium ID 80\,\%. In the barrel and end caps, the loose ID rejects 86\,\% and 77\,\% of background, respectively, while the medium ID removes 89\,\% and 82\,\%, respectively. Both collections must also pass the electron conversion veto to ensure they originate promptly from the primary vertex.

\begin{table}[htbp]
    \centering
    \begin{tabular}{lcc}
        \hline
        Criterion & Loose & Medium \\\hline
        $H/E$ & $< \text{0.04596}$ & $< \text{0.02197}$ \\
        $\sigma_{i\eta i\eta}$ & $< \text{0.0106}$ & $< \text{0.01015}$ \\
        $\rho$-corrected \acrshort{pf} charged hadron isolation & $< \text{1.694}$ & $< \text{1.141}$ \\
        $\rho$-corrected \acrshort{pf} neutral hadron isolation & $< \text{24.032} + X + Y$ & $< \text{1.189} + X + Y$ \\
        $\rho$-corrected \acrshort{pf} photon isolation & $< \text{2.876} + Z$ & $< \text{2.08} + Z$ \\\hline
    \end{tabular}
    \caption[Requirements used to define the loose and medium photon IDs in the barrel region of the detector ($\abs{\eta} \leq \text{1.479}$)]{Requirements used to define the loose and medium photon IDs in the barrel region of the detector ($\abs{\eta} \leq \text{1.479}$). The factors $X = \text{0.01512}\pt$, $Y = \text{2.259} \times \text{10}^{-5}\pt^2$, and $Z = \text{0.004017}\pt$ in the isolation criteria are used to scale the threshold. Information taken from Ref.~\citenum{cms_photon_ID_Run2}.}
    \label{tab:htoinv_photon_ID_barrel}
\end{table}

\begin{table}[htbp]
    \centering
    \begin{tabular}{lcc}
        \hline
        Criterion & Loose & Medium \\\hline
        $H/E$ & $< \text{0.0590}$ & $< \text{0.0326}$ \\
        $\sigma_{i\eta i\eta}$ & $< \text{0.0272}$ & $< \text{0.0272}$ \\
        $\rho$-corrected \acrshort{pf} charged hadron isolation & $< \text{2.089}$ & $< \text{1.051}$ \\
        $\rho$-corrected \acrshort{pf} neutral hadron isolation & $< \text{1.922} + X + Y$ & $< \text{2.718} + X + Y$ \\
        $\rho$-corrected \acrshort{pf} photon isolation & $< \text{4.162} + Z$ & $< \text{3.867} + Z$ \\\hline
    \end{tabular}
    \caption[Requirements used to define the loose and medium photon IDs in the end cap region of the detector ($\abs{\eta} > \text{1.479}$)]{Requirements used to define the loose and medium photon IDs in the end cap region of the detector ($\abs{\eta} > \text{1.479}$). The factors $X = \text{0.0117}\pt$, $Y = \text{2.3} \times \text{10}^{-5}\pt^2$, and $Z = \text{0.0037}\pt$ in the isolation criteria are used to scale the threshold. Information taken from Ref.~\citenum{cms_photon_ID_Run2}.}
    \label{tab:htoinv_photon_ID_endcap}
\end{table}

The variables $\sigma_{i\eta i\eta}$ and $\rho$ follow the same definitions as in Chpt.~\ref{subsec:objects_electrons}. The $\rho$-corrected isolation is calculated by taking the maximum of zero, and the difference between the \acrlong{pf} isolation and possible contamination from pileup:
\begin{equation}
I_{\mathrm{PF}}^{\mathrm{corr.}} = \max (I_{\mathrm{PF}} - \rho A_{\mathrm{eff.}}, \text{0})
\end{equation}

As well as the ID, the two collections diverge further due to $\eta$ and \pt requirements. A loose photon is characterised by $\abseta < \text{2.5}$ and $\pt > \text{15}\GeV$, while a medium photon must be central ($\abseta < \text{1.442}$) and possess $\pt > \text{230}\GeV$.


%=========================================================


\subsection{Tau leptons}
\label{subsec:objects_taus}

The only purpose tau leptons \Ptau serve in the analysis is to veto events that contain them. We denote these as ``very loose'' taus \vlooseTau. Version 2 of the multivariate identification algorithm is used for all years, and tau leptons must pass the very loose criteria. Dedicated multivariate discriminators against electrons and muons are provided and employed, passing the loose and very loose working points, respectively. Kinematically, a \vlooseTau also requires $\pt > \text{20}\GeV$, $\abseta < \text{2.3}$, and $dz <\text{0.2}$\,cm.

% Tau ID: https://twiki.cern.ch/twiki/bin/viewauth/CMS/TauIDRecommendationForRun2. But no real useful information is there


%=========================================================


\subsection{Overlap removal}
\label{subsec:objects_cross_cleaning}

Particle detection is not a straightforward process. As such, there may be particles identified close together in an event either due to real physics or misreconstruction. To ensure only well-measured and correctly-identified objects are used in analysis, particles considered to be overlapping are removed---or \emph{cross cleaned}---between the different classes. This is performed in the following order.

Muons are first identified, followed by electrons. Cross cleaning is performed against the \looseMuon collection of objects, so electrons are not counted in the event if they are within $\Delta R < \text{0.3}$ of one. Photons are next in the list. Both the \loosePhoton and \mediumPhoton collections are cross-cleaned against \looseMuon and \vetoEle objects in the event with $\Delta R < \text{0.3}$. The same collections and separation are used to remove overlap with the set \vlooseTau leptons. Finally, \glspl{jet} are identified, with those in the AK4 collection requiring a separation of $\Delta R > \text{0.4}$ from any electron, muon, and photon defined previously.


%=========================================================


\subsection{Revised energy sums \texorpdfstring{\ptvecmiss}{ptmiss}, \texorpdfstring{\HT}{HT}, and \texorpdfstring{\htvecmiss}{MHT}}
\label{subsec:objects_analysis_energy_sums}

Most \acrshort{cms} analyses, including those presented in this thesis, define the missing transverse momentum with the ``type-I correction'': corrections to the \acrshort{jer} and \acrshort{jes} are applied as in Chpt.~\ref{subsec:objects_jets}, and so the corrected \gls{jet} \ptvec are propagated to the calculation of \ptvecmiss. Uncertainties are calculated in the same manner as \glspl{jet}.

In 2017, significant noise in the \acrshort{ecal} end cap affected \glspl{jet} and \ptmiss, leading to potentially large energy mismeasurements. These quantities were recomputed after reconstruction, and carried through the analysis.

The scalar sum \HT and negative vector sum of hadronic transverse momentum \htvecmiss are broadly defined in Chpts.~\ref{subsec:objects_ht} and \ref{subsec:objects_met}, respectively. They are calculated from the analysis-level AK4 jets with $\pt > \text{30}\GeV$, as detailed in Chpt.~\ref{subsec:objects_jets}.

Regarding the \ptvecmiss and \htvecmiss, in most cases the magnitudes (\ptmiss and \mht, respectively) are the important quantities used in the event selection and other aspects of the analysis.


%=========================================================
